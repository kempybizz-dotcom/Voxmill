<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voxmill Executive Intelligence Deck</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700;800&family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Master CSS - All layers combined -->
   <link rel="stylesheet" href="voxmill_production.css">
    
    <style>
        /* Page setup for PDF generation */
        @page {
            size: 1920px 1480px;
            margin: 0;
        }
        
        body {
            margin: 0;
            padding: 0;
            background: #0C0C0C;
            font-family: 'Inter', Arial, sans-serif;
            color: #EAEAEA;
            width: 1920px;
            min-height: 1480px;
        }
        
        .slide {
            width: 1920px;
            height: 1480px;
            position: relative;
            page-break-after: always;
            background: #0C0C0C;
            overflow: visible !important;
        }
        
        .slide:last-child {
            page-break-after: auto;
        }
    </style>
</head>
<body>

<!-- ============================================
SLIDE 1: COVER PAGE
============================================ -->
<div class="slide slide-cover">
    <div class="cover-overlay"></div>
    
    <div class="cover-content">
        <div class="cover-title">Voxmill Executive<br/>Intelligence Deck</div>
        <div class="cover-subtitle">{{ market_name }} Market Analysis</div>
        <div class="cover-date">{{ report_date }}</div>
        <div class="cover-compiled">Compiled by Voxmill Analytics</div>
    </div>
</div>

<!-- ============================================
SLIDE 2: EXECUTIVE SUMMARY
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Executive Summary</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Executive Summary Bullets -->
        <div class="executive-summary-bullets">
            {% for bullet in executive_summary_bullets %}
            <div class="executive-summary-bullet">
                <div class="executive-bullet-title">{{ bullet.title }}</div>
                <div class="executive-bullet-text">{{ bullet.text }}</div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Weekly Movement Dashboard -->
        <div class="weekly-movement-dashboard">
            <div class="dashboard-row">
                {% for card in movement_cards %}
                <div class="movement-mini-card">
                    <div class="movement-label">{{ card.label }}</div>
                    <div class="movement-value">{{ card.value }}</div>
                    <div class="movement-change {{ 'positive' if card.change >= 0 else 'negative' }}">
                        {{ '+' if card.change >= 0 else '' }}{{ card.change }}%
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 3: MARKET OVERVIEW
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Market Overview</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- KPI Grid -->
        <div class="kpi-grid">
            <!-- Total Active Listings -->
            <div class="kpi-card">
                <div class="kpi-label">TOTAL ACTIVE LISTINGS</div>
                <div class="kpi-value">{{ "{:,}".format(kpis.total_listings or 0) }}</div>
                <div class="kpi-change {{ 'positive' if (kpis.listings_change or 0) >= 0 else 'negative' }}">
                    {{ '+' if (kpis.listings_change or 0) >= 0 else '' }}{{ kpis.listings_change or 0 }}% vs. last period
                </div>
                <div class="kpi-bar">
                    <div class="kpi-bar-fill" style="width: {{ (kpis.listings_change or 0) + 50 }}%"></div>
                </div>
            </div>
            
            <!-- Median Value -->
            <div class="kpi-card">
                <div class="kpi-label">MEDIAN {{ value_metric_label }}</div>
                <div class="kpi-value">£{{ "{:,.0f}".format(kpis.median_price or 0) }}</div>
                <div class="kpi-change {{ 'positive' if (kpis.price_change or 0) >= 0 else 'negative' }}">
                    {{ '+' if (kpis.price_change or 0) >= 0 else '' }}{{ kpis.price_change or 0 }}% vs. last period
                </div>
                <div class="kpi-bar">
                    <div class="kpi-bar-fill" style="width: {{ (kpis.price_change or 0) + 50 }}%"></div>
                </div>
            </div>
            
            <!-- Average Days Listed -->
            <div class="kpi-card">
                <div class="kpi-label">AVG. DAYS LISTED</div>
                <div class="kpi-value">{{ kpis.avg_days_listed or 0 }}</div>
                <div class="kpi-change {{ 'positive' if (kpis.days_change or 0) <= 0 else 'negative' }}">
                    {{ '+' if (kpis.days_change or 0) >= 0 else '' }}{{ kpis.days_change or 0 }}% vs. last period
                </div>
                <div class="kpi-bar">
                    <div class="kpi-bar-fill" style="width: {{ 50 - (kpis.days_change or 0) }}%"></div>
                </div>
            </div>
            
            <!-- Market Velocity -->
            <div class="kpi-card">
                <div class="kpi-label">MARKET VELOCITY SCORE</div>
                <div class="kpi-value">{{ kpis.velocity_score or 0 }}</div>
                <div class="kpi-change {{ 'positive' if (kpis.velocity_change or 0) >= 0 else 'negative' }}">
                    {{ '+' if (kpis.velocity_change or 0) >= 0 else '' }}{{ kpis.velocity_change or 0 }}% vs. last period
                </div>
                <div class="kpi-bar">
                    <div class="kpi-bar-fill" style="width: {{ (kpis.velocity_change or 0) + 50 }}%"></div>
                </div>
            </div>
        </div>
        
        <!-- Value Distribution Chart -->
        <div class="chart-section">
            <div class="chart-container">
                <div class="chart-title">Value Distribution</div>
                <div class="chart-context">Distribution of active listings by {{ value_metric_label|lower }} bracket</div>
                
                <svg width="100%" height="260" viewBox="0 0 1700 260" preserveAspectRatio="xMidYMid meet">
                    <text x="35" y="120" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.85)" text-anchor="middle" transform="rotate(-90, 35, 120)" class="chart-axis-label">Count</text>
                    
                    <!-- Axes - 3px stroke -->
                    <line x1="80" y1="40" x2="80" y2="200" stroke="rgba(255,255,255,0.28)" stroke-width="3"/>
                    <line x1="80" y1="200" x2="1620" y2="200" stroke="rgba(255,255,255,0.28)" stroke-width="3"/>
                    
                    <!-- Grid lines - 1.8px stroke -->
                    <line x1="80" y1="85" x2="1620" y2="85" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    <line x1="80" y1="120" x2="1620" y2="120" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    <line x1="80" y1="155" x2="1620" y2="155" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    
                    {% for bar in chart_data.price_distribution %}
                    <rect x="{{ 200 + loop.index0 * 350 }}" 
                          y="{{ 200 - (bar.height * 0.9) }}" 
                          width="200" 
                          height="{{ bar.height * 0.9 }}" 
                          fill="url(#barGradient)" 
                          stroke="#BFA670" 
                          stroke-width="3"
                          rx="6"
                          style="filter: drop-shadow(0 2px 8px rgba(191, 166, 112, 0.4)) drop-shadow(0 0 4px rgba(191, 166, 112, 0.02));"/>
                    <text x="{{ 300 + loop.index0 * 350 }}" 
                          y="{{ 185 - (bar.height * 0.9) }}" 
                          font-family="Inter" 
                          font-size="24" 
                          font-weight="700"
                          fill="#BFA670" 
                          text-anchor="middle"
                          style="text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);">{{ bar.count }}</text>
                    <text x="{{ 300 + loop.index0 * 350 }}" 
                          y="225" 
                          font-family="Inter" 
                          font-size="18" 
                          fill="rgba(255,255,255,0.85)" 
                          text-anchor="middle" 
                          class="chart-axis-label">{{ bar.label }}</text>
                    {% endfor %}
                    
                    <text x="850" y="255" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.85)" text-anchor="middle" class="chart-axis-label">Value Brackets (£)</text>
                    
                    <defs>
                        <linearGradient id="barGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#BFA670;stop-opacity:0.95" />
                            <stop offset="50%" style="stop-color:#B59854;stop-opacity:0.85" />
                            <stop offset="100%" style="stop-color:#8B7045;stop-opacity:0.65" />
                        </linearGradient>
                    </defs>
                </svg>
                
                <div class="chart-source">Source: Voxmill Analytics | Data as of {{ report_date }}</div>
            </div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 4: PERFORMANCE ANALYSIS
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Performance Analysis</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Two Column Layout -->
        <div class="two-column">
            <!-- Price Range Distribution -->
            <div class="chart-panel">
                <div class="chart-title">{{ value_metric_label }} Range Distribution</div>
                <div class="chart-context">Percentage of active assets by {{ value_metric_label|lower }} tier</div>
                
                <svg width="100%" height="440" viewBox="0 0 700 440">
                    <!-- Y-axis - 3px stroke -->
                    <line x1="280" y1="40" x2="280" y2="380" stroke="rgba(255,255,255,0.28)" stroke-width="3"/>
                    
                    <!-- Grid lines - 1.8px stroke -->
                    <line x1="350" y1="40" x2="350" y2="380" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    <line x1="420" y1="40" x2="420" y2="380" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    <line x1="490" y1="40" x2="490" y2="380" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    <line x1="560" y1="40" x2="560" y2="380" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    <line x1="630" y1="40" x2="630" y2="380" stroke="rgba(255,255,255,0.14)" stroke-width="1.8"/>
                    
                    <text x="5" y="210" font-family="Inter" font-size="14" font-weight="600" fill="rgba(214,214,214,0.9)" text-anchor="middle" transform="rotate(-90, 5, 210)" letter-spacing="0.08em" class="chart-axis-label">% of Assets</text>
                    
                    {% for item in chart_data.price_ranges %}
                    <text x="25" y="{{ 90 + loop.index0 * 70 }}" font-family="Inter" font-size="16" fill="#EAEAEA">{{ item.range }}</text>
                    <rect x="280" 
                          y="{{ 75 + loop.index0 * 70 }}" 
                          width="{{ item.percentage * 3.5 }}" 
                          height="28" 
                          fill="url(#horizontalGradient)" 
                          stroke="#BFA670" 
                          stroke-width="3"
                          rx="6"
                          style="filter: drop-shadow(0 2px 8px rgba(191, 166, 112, 0.4)) drop-shadow(0 0 4px rgba(191, 166, 112, 0.02));"/>
                    <text x="{{ 290 + item.percentage * 3.5 }}" 
                          y="{{ 95 + loop.index0 * 70 }}" 
                          font-family="Inter" 
                          font-size="16" 
                          font-weight="600"
                          fill="#BFA670">{{ item.percentage }}%</text>
                    {% endfor %}
                    
                    <text x="480" y="425" font-family="Inter" font-size="14" font-weight="600" fill="rgba(214,214,214,0.9)" text-anchor="middle" letter-spacing="0.08em" class="chart-axis-label">Percentage (%)</text>
                    
                    <defs>
                        <linearGradient id="horizontalGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#B59854;stop-opacity:0.7" />
                            <stop offset="100%" style="stop-color:#BFA670;stop-opacity:0.95" />
                        </linearGradient>
                    </defs>
                </svg>
                
                <div class="chart-source">Source: Voxmill Analytics</div>
            </div>
            
            <!-- Weekly Trend Chart -->
            <div class="chart-panel">
                <div class="chart-title">Weekly Trend</div>
                <div class="chart-context">Average {{ value_metric_label|lower }} by day of week</div>
                
                <svg width="100%" height="500" viewBox="0 0 700 500" preserveAspectRatio="xMidYMid meet">
                    <!-- Y-axis - 3px stroke -->
                    <line x1="70" y1="50" x2="70" y2="460" stroke="rgba(255,255,255,0.28)" stroke-width="3"/>
                    <line x1="70" y1="460" x2="670" y2="460" stroke="rgba(255,255,255,0.28)" stroke-width="3"/>
                    
                    <!-- Grid lines - 1.8px stroke -->
                    <line x1="70" y1="120" x2="670" y2="120" stroke="rgba(255,255,255,0.14)" stroke-width="1.8" stroke-dasharray="6,6"/>
                    <line x1="70" y1="205" x2="670" y2="205" stroke="rgba(255,255,255,0.14)" stroke-width="1.8" stroke-dasharray="6,6"/>
                    <line x1="70" y1="290" x2="670" y2="290" stroke="rgba(255,255,255,0.14)" stroke-width="1.8" stroke-dasharray="6,6"/>
                    <line x1="70" y1="375" x2="670" y2="375" stroke="rgba(255,255,255,0.14)" stroke-width="1.8" stroke-dasharray="6,6"/>
                    
                    <!-- Data line - 4px stroke with gold glow -->
                    <polyline 
                        points="{% for point in chart_data.weekly_trend %}{{ 100 + loop.index0 * 120 }},{{ 460 - (point.value * 0.95) }}{% if not loop.last %} {% endif %}{% endfor %}" 
                        fill="none" 
                        stroke="#BFA670" 
                        stroke-width="4"
                        style="filter: drop-shadow(0 2px 6px rgba(191, 166, 112, 0.5)) drop-shadow(0 0 4px rgba(191, 166, 112, 0.03));"/>
                    
                    <!-- Data points - 8px radius with gold glow -->
                    {% for point in chart_data.weekly_trend %}
                    <circle cx="{{ 100 + loop.index0 * 120 }}" 
                            cy="{{ 460 - (point.value * 0.95) }}" 
                            r="8" 
                            fill="#BFA670" 
                            stroke="#0C0C0C" 
                            stroke-width="3"
                            style="filter: drop-shadow(0 3px 10px rgba(191, 166, 112, 0.7)) drop-shadow(0 0 6px rgba(191, 166, 112, 0.03));"/>
                    <text x="{{ 100 + loop.index0 * 120 }}" 
                          y="485" 
                          font-family="Inter" 
                          font-size="14" 
                          font-weight="600"
                          fill="rgba(214,214,214,0.9)" 
                          text-anchor="middle" 
                          letter-spacing="0.6" 
                          class="chart-axis-label">{{ point.label }}</text>
                    {% endfor %}
                    
                    <!-- Axis labels -->
                    <text x="25" y="260" font-family="Inter" font-size="14" font-weight="600" fill="rgba(214,214,214,0.9)" text-anchor="middle" transform="rotate(-90, 25, 260)" letter-spacing="0.8" class="chart-axis-label">£/{{ unit_metric }}</text>
                    <text x="370" y="510" font-family="Inter" font-size="14" font-weight="600" fill="rgba(214,214,214,0.9)" text-anchor="middle" letter-spacing="0.8" class="chart-axis-label">Day of Week</text>
                </svg>
                
                <div class="chart-source">Source: Voxmill Analytics | 7-day rolling average</div>
            </div>
        </div>
        
        <!-- Market Insights -->
        <div class="insight-cards">
            {% for insight in market_insights[:3] %}
            <div class="insight-card">
                <div class="insight-title">{{ insight.title }}</div>
                <div class="insight-text">{{ insight.text }}</div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 5: COMPETITIVE LANDSCAPE
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Competitive Landscape</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Two Column Layout -->
        <div class="two-column">
            <!-- Market Share Gauge -->
            <div class="chart-panel">
                <div class="chart-title">Market Concentration</div>
                <div class="chart-context">{{ top_n_competitors or 5 }} largest competitors by active inventory</div>
                
                <!-- Radial Gauge Chart -->
                <svg width="100%" height="500" viewBox="0 0 500 500">
                    <defs>
                        <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#BFA670;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#B59854;stop-opacity:0.8" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Background arc -->
                    <path d="M 100 250 A 150 150 0 1 1 400 250" 
                          fill="none" 
                          stroke="rgba(255,255,255,0.1)" 
                          stroke-width="30"/>
                    
                    <!-- Value arc -->
                    <path d="M 100 250 A 150 150 0 {{ '1' if (competitive_data.market_concentration or 0) > 50 else '0' }} 1 {{ 100 + 300 * ((competitive_data.market_concentration or 0) / 100) }} 250" 
                          fill="none" 
                          stroke="url(#gaugeGradient)" 
                          stroke-width="30"
                          stroke-linecap="round"/>
                    
                    <!-- Center value -->
                    <text x="250" y="240" 
                          font-family="Inter" 
                          font-size="72" 
                          font-weight="700"
                          fill="#BFA670" 
                          text-anchor="middle">{{ competitive_data.market_concentration or 0 }}%</text>
                    <text x="250" y="270" 
                          font-family="Inter" 
                          font-size="16" 
                          fill="rgba(184,184,184,0.7)" 
                          text-anchor="middle">Market Concentration</text>
                </svg>
                
                <div class="chart-source">Top {{ top_n_competitors or 5 }} competitors | {{ report_date }}</div>
            </div>
            
            <!-- Active Inventory Table - REDESIGNED (3-column layout) -->
            <div class="competitive-inventory-executive-panel">
                <div class="competitive-inventory-executive-title">Competitor Active Inventory</div>
                
                <div class="competitive-inventory-executive-list">
                    {% for comp in competitive_data.competitors[:8] %}
                    <div class="competitor-row-executive">
                        <!-- Left: Company name + count -->
                        <div class="competitor-left-executive">
                            <div class="competitor-name-executive">{{ comp.name }}</div>
                            <div class="competitor-count-executive">{{ "{:,}".format(comp.count or 0) }} active listings</div>
                        </div>
                        
                        <!-- Center: Market % -->
                        <div class="competitor-center-executive">
                            <div class="inventory-bar-executive">
                                <div class="inventory-bar-fill-executive" style="width: {{ comp.market_share or 0 }}%"></div>
                                <span class="inventory-bar-text">{{ comp.market_share or 0 }}%</span>
                            </div>
                        </div>
                        
                        <!-- Right: Velocity badge -->
                        <div class="competitor-right-executive">
                            <span class="velocity-badge-executive velocity-{{ 'high-exec' if (comp.velocity or 0) >= 70 else 'medium-exec' if (comp.velocity or 0) >= 50 else 'weak-exec' }}">
                                {{ comp.velocity or 0 }}
                            </span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <!-- Competitive Insights Strip -->
        <div class="competitive-insights-strip">
            {% for insight in competitive_insights[:3] %}
            <div class="competitive-insight-point">
                <span class="competitive-insight-icon">→</span>
                <span class="competitive-insight-text">{{ insight }}</span>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 6: CROSS-VERTICAL MOMENTUM
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Cross-Vertical Momentum</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Cross-Vertical Grid -->
        <div class="cross-vertical-grid">
            {% for vertical in cross_vertical_data %}
            <div class="cross-vertical-card">
                <div class="cross-vertical-icon">{{ vertical.icon }}</div>
                <div class="cross-vertical-title">{{ vertical.title }}</div>
                <div class="cross-vertical-text">{{ vertical.description }}</div>
                <ul class="cross-vertical-bullets">
                    {% for bullet in vertical.bullets %}
                    <li>{{ bullet }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endfor %}
        </div>
        
        <!-- Momentum Correlation Panel -->
        <div class="momentum-correlation-panel">
            <div class="panel-title">Momentum Correlation Analysis</div>
            <div class="panel-text">{{ momentum_correlation_text }}</div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 7: MARKET DEPTH ANALYSIS
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Market Depth Analysis</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Heatmap Table -->
        <table class="heatmap-table">
            <thead>
                <tr>
                    <th style="text-align: left; padding-left: 24px;">Segment Type</th>
                    <th>Avg {{ value_metric_label }}</th>
                    <th>{{ velocity_metric_label }} Score</th>
                    <th>Market Signal</th>
                </tr>
            </thead>
            <tbody>
                {% if market_depth.property_type_performance %}
                {% for ptype in market_depth.property_type_performance %}
                <tr>
                    <td class="property-type-name" style="text-align: left; padding-left: 24px;">{{ ptype.type or "Unknown" }}</td>
                    <td>£{{ "{:,.0f}".format(ptype.avg_price or 0) }}</td>
                    <td>
                        <span class="velocity-badge velocity-{{ 'high' if (ptype.velocity_score or 0) >= 70 else 'medium' if (ptype.velocity_score or 0) >= 50 else 'low' }}">
                            {{ ptype.velocity_score or 0 }}
                        </span>
                    </td>
                    <td class="signal-text">{{ "Strong Demand" if (ptype.velocity_score or 0) >= 70 else "Moderate" if (ptype.velocity_score or 0) >= 50 else "Weak" }}</td>
                </tr>
                {% endfor %}
                {% endif %}
            </tbody>
        </table>
        
        <!-- Depth Metrics Grid -->
        <div class="depth-metrics">
            {% for depth in depth_metrics %}
            <div class="depth-card">
                <div class="depth-label">{{ depth.label }}</div>
                <div class="depth-value">{{ depth.value }}</div>
                <div class="depth-bar">
                    <div class="depth-bar-fill" style="width: {{ depth.percentage }}%"></div>
                </div>
                <div class="depth-note">{{ depth.note }}</div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 8: STRATEGIC FORECAST
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Strategic Forecast</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Forecast Grid 2x2 - REDESIGNED Top Two Cards -->
        <div class="forecast-grid-2x2">
            <!-- Top Left: 30-Day Momentum Forecast - REDESIGNED -->
            <div class="forecast-card-v2 forecast-card-momentum">
                <div class="forecast-card-header-v2">
                    <div class="forecast-card-title">30-Day Momentum Forecast</div>
                    <div class="forecast-card-subtitle">Market velocity & demand pressure projection</div>
                </div>
                
                <div class="forecast-card-body-v2">
                    <div class="forecast-primary-section">
                        <div class="forecast-primary-label">PROJECTED {{ velocity_metric_label|upper }}</div>
                        <div class="forecast-primary-value">{{ forecast.momentum_30d.value or 0 }}</div>
                        <div class="forecast-primary-change {{ 'positive' if (forecast.momentum_30d.change or 0) >= 0 else 'negative' }}">
                            {{ '+' if (forecast.momentum_30d.change or 0) >= 0 else '' }}{{ forecast.momentum_30d.change or 0 }}% from current
                        </div>
                    </div>
                    
                    <div class="forecast-confidence-bar">
                        <div class="forecast-confidence-label">Confidence</div>
                        <div class="momentum-confidence-fill" style="width: {{ forecast.momentum_30d.confidence or 0 }}%"></div>
                        <span class="forecast-confidence-value">{{ forecast.momentum_30d.confidence or 0 }}%</span>
                    </div>
                    
                    <div class="forecast-meta-label">Model: {{ forecast.momentum_30d.model or "Voxmill Momentum Engine" }}</div>
                </div>
            </div>
            
            <!-- Top Right: 90-Day Trend Cone - REDESIGNED -->
            <div class="forecast-card-v2 forecast-card-cone">
                <div class="forecast-card-header-v2">
                    <div class="forecast-card-title">90-Day Trend Cone</div>
                    <div class="forecast-card-subtitle">Probabilistic {{ value_metric_label|lower }} movement range</div>
                </div>
                
                <div class="forecast-card-body-v2">
                    <div class="cone-range-display">
                        <div class="cone-value-executive cone-high">
                            <div class="cone-label-executive">OPTIMISTIC</div>
                            <div class="cone-value-number">£{{ "{:,.0f}".format(forecast.trend_cone_90d.high or 0) }}</div>
                        </div>
                        
                        <div class="cone-separator"></div>
                        
                        <div class="cone-value-executive cone-base">
                            <div class="cone-label-executive">BASE CASE</div>
                            <div class="cone-value-number">£{{ "{:,.0f}".format(forecast.trend_cone_90d.base or 0) }}</div>
                        </div>
                        
                        <div class="cone-separator"></div>
                        
                        <div class="cone-value-executive cone-low">
                            <div class="cone-label-executive">CONSERVATIVE</div>
                            <div class="cone-value-number">£{{ "{:,.0f}".format(forecast.trend_cone_90d.low or 0) }}</div>
                        </div>
                    </div>
                    
                    <div class="forecast-meta-label">Confidence Band: ±{{ forecast.trend_cone_90d.band or 15 }}% | Model: Voxmill Trend Cone</div>
                </div>
            </div>
            
            <!-- Bottom Left: Risk Dial -->
            <div class="risk-dial-card">
                <div class="risk-dial-title">Market Risk Index</div>
                <div class="risk-dial-value">{{ forecast.risk_index or 0 }}</div>
                <div class="risk-dial-gauge">
                    <div class="risk-dial-fill" style="width: {{ forecast.risk_index or 0 }}%"></div>
                </div>
                <div class="risk-dial-status">{{ "High Risk" if (forecast.risk_index or 0) >= 70 else "Moderate Risk" if (forecast.risk_index or 0) >= 40 else "Low Risk" }}</div>
            </div>
            
            <!-- Bottom Right: Voxmill Predictive Index -->
            <div class="forecast-card-v2">
                <div class="forecast-card-title">Voxmill Predictive Index</div>
                <div class="voxmill-index-number">{{ forecast.voxmill_index or 0 }}</div>
                <div class="voxmill-index-bar-container">
                    <div class="voxmill-index-bar-fill" style="width: {{ forecast.voxmill_index or 0 }}%"></div>
                </div>
                <div class="voxmill-index-caption">Composite Market Strength (0-100)</div>
                <div class="forecast-label-text">Blend of liquidity, demand pressure, and {{ forward_indicator_label|lower }}</div>
            </div>
        </div>
        
        <!-- Macro Context -->
        <div class="macro-context">
            <div class="macro-title">Macro Context & Strategic Implications</div>
            <div class="macro-text">{{ macro_context_text }}</div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 9: EXECUTIVE INTELLIGENCE
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Executive Intelligence</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Executive Intelligence Layout - REDESIGNED Bullets -->
        <div class="executive-intelligence-layout">
            <div class="executive-insights-list">
                {% for insight in executive_insights %}
                <div class="executive-insight-item">
                    <div class="executive-insight-number">{{ loop.index }}</div>
                    <div class="executive-insight-content">
                        <div class="executive-insight-label">{{ insight.category|upper }}</div>
                        <div class="executive-insight-text">{{ insight.text }}</div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <!-- Strategic Action Window - REDESIGNED (4-column layout) -->
        <div class="action-window">
            <div class="action-window-header">
                <div class="action-window-title">Strategic Action Window</div>
                <div class="action-window-subtitle">Recommended immediate tactical moves</div>
            </div>
            
            <div class="action-window-grid">
                {% for action in strategic_actions %}
                <div class="action-window-item">
                    <div class="action-window-label">{{ action.category|upper }}</div>
                    <div class="action-window-text">{{ action.text }}</div>
                    <div class="action-window-divider"></div>
                    <div class="action-window-timeline">{{ action.timeline }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <!-- Executive Bottom Strip -->
        <div class="executive-bottom-strip">
            <div class="executive-bottom-text">{{ executive_bottom_note }}</div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 10: TOP MARKET OPPORTUNITIES
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Top Market Opportunities</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Opportunities Table -->
        <div class="chart-section">
            <table class="table-luxury">
                <thead>
                    <tr>
                        <th style="text-align: left; padding-left: 24px;">Asset</th>
                        <th>Type</th>
                        <th>Size</th>
                        <th>{{ value_metric_label }}</th>
                        <th>£/{{ unit_metric }}</th>
                        <th>Days</th>
                        <th style="text-align: center; padding-right: 24px;">Score</th>
                    </tr>
                </thead>
                <tbody>
                    {% for opportunity in top_opportunities[:8] %}
                    <tr>
                        <td class="property-address" style="text-align: left; padding-left: 24px;">{{ (opportunity.address or "Address not available")[:45] }}</td>
                        <td>{{ opportunity.property_type or "N/A" }}</td>
                        <td class="align-right">{{ "{:,}".format(opportunity.size or 0) }} {{ unit_metric }}</td>
                        <td class="align-right">£{{ "{:,.0f}".format(opportunity.price or 0) }}</td>
                        <td class="align-right">£{{ "{:,.0f}".format(opportunity.price_per_sqft or 0) }}</td>
                        <td class="align-center">{{ opportunity.days_listed or 0 }}</td>
                        <td class="align-center" style="padding-right: 24px;">
                            <span class="score-badge score-{{ opportunity.score_class or 'standard' }}">{{ opportunity.score or 0 }}</span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="opportunities-section-divider"></div>
        
        <!-- Opportunity Insights -->
        <div class="insight-cards">
            {% for insight in opportunity_insights[:3] %}
            <div class="insight-card">
                <div class="insight-title">{{ insight.title }}</div>
                <div class="insight-text">{{ insight.text }}</div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 11: METHODOLOGY & DATA INTELLIGENCE
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Methodology & Data Intelligence</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Methodology Grid -->
        <div class="methodology-grid">
            <div class="methodology-panel">
                <div class="methodology-title">Data Sources</div>
                <ul class="methodology-list">
                    {% for source in data_sources %}
                    <li>{{ source }}</li>
                    {% endfor %}
                </ul>
            </div>
            
            <div class="methodology-panel">
                <div class="methodology-title">Analysis Framework</div>
                <ul class="methodology-list">
                    {% for framework in analysis_framework %}
                    <li>{{ framework }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        
        <!-- Intelligence Pipeline -->
        <div class="model-pipeline">
            <div class="panel-title">Voxmill Intelligence Pipeline</div>
            <div class="pipeline-flow">
                {% for stage in intelligence_pipeline %}
                <div class="pipeline-stage">
                    <div class="pipeline-stage-number">{{ loop.index }}</div>
                    <div class="pipeline-stage-label">{{ stage.label }}</div>
                    <div class="pipeline-stage-desc">{{ stage.description }}</div>
                </div>
                {% if not loop.last %}
                <div class="pipeline-arrow">→</div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 12: MACRO RISK MAP
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Macro Risk Map</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Macro Risk Grid -->
        <div class="macro-risk-grid">
            {% for risk in macro_risks %}
            <div class="risk-dial-card">
                <div class="risk-dial-title">{{ risk.title }}</div>
                <div class="risk-dial-value">{{ risk.score }}</div>
                <div class="risk-dial-gauge">
                    <div class="risk-dial-fill" style="width: {{ risk.score }}%"></div>
                </div>
                <div class="risk-dial-status">{{ risk.status }}</div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Extended Risk Map -->
        <div class="macro-risk-map-extended">
            <div class="panel-title">Risk Correlation Matrix</div>
            <div class="panel-text">{{ risk_correlation_text }}</div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 13: SUBMARKET SEGMENTATION
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Submarket Segmentation</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Submarket Grid -->
        <div class="submarket-grid-v2">
            {% for submarket in submarkets %}
            <div class="submarket-card-v2">
                <div class="submarket-header">{{ submarket.name }}</div>
                <div class="submarket-metric">
                    <div class="submarket-metric-label">Median {{ value_metric_label }}</div>
                    <div class="submarket-metric-value">£{{ "{:,.0f}".format(submarket.median_price or 0) }}</div>
                </div>
                <div class="submarket-metric">
                    <div class="submarket-metric-label">Active Listings</div>
                    <div class="submarket-metric-value">{{ "{:,}".format(submarket.listings or 0) }}</div>
                </div>
                <div class="submarket-metric">
                    <div class="submarket-metric-label">{{ velocity_metric_label }}</div>
                    <div class="submarket-metric-value">{{ submarket.velocity or 0 }}</div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Momentum Streets Panel -->
        <div class="momentum-streets-panel">
            <div class="momentum-title">High-Momentum Streets</div>
            <div class="momentum-list">
                {% for street in high_momentum_streets %}
                <div class="momentum-signal-box">
                    <div class="momentum-signal-name">{{ street.name }}</div>
                    <div class="momentum-signal-text">{{ street.description }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- ============================================
SLIDE 14: ACQUISITION FLAGGING SYSTEM
============================================ -->
<div class="slide">
    <div class="slide-header">
        <h1 class="slide-title">Acquisition Flagging System</h1>
        <div class="slide-meta">{{ report_date }}<br/>{{ market_name }}</div>
    </div>
    
    <div class="slide-content">
        <!-- Acquisition Flagging Header -->
        <div class="acquisition-flagging-header">
            <div class="acquisition-flagging-title">Live Signal Board</div>
            <div class="acquisition-flagging-subtitle">Real-time acquisition opportunities ranked by composite scoring</div>
        </div>
        
        <!-- Signal Board -->
        <div class="signal-board-v2">
            {% for signal in acquisition_signals %}
            <div class="signal-card-v2">
                <div class="signal-header-v2">
                    <div class="signal-label-v2">{{ signal.category|upper }}</div>
                    <div class="signal-score-v2">{{ signal.score }}</div>
                </div>
                <div class="signal-address-v2">{{ signal.address }}</div>
                <div class="signal-metrics-v2">
                    <span>£{{ "{:,.0f}".format(signal.price or 0) }}</span>
                    <span>{{ signal.size }} {{ unit_metric }}</span>
                    <span>{{ signal.days }} days</span>
                </div>
                <div class="signal-reason-v2">{{ signal.reason }}</div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Acquisition Strategy Ribbon -->
        <div class="acquisition-strategy-ribbon">
            <div class="acquisition-strategy-title">Strategic Acquisition Guidance</div>
            <div class="acquisition-strategy-text">{{ acquisition_strategy_text }}</div>
        </div>
    </div>
</div>

</body>
</html>
