<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voxmill Market Intelligence</title>
    <link rel="stylesheet" href="voxmill_style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;600&family=IBM+Plex+Mono:wght@500&display=swap" rel="stylesheet">
</head>
<body>

<!-- PAGE 1: MARKET SNAPSHOT -->
<section class="page page-cover">
    <div class="cover-header">
        <div class="bronze-line"></div>
        <div class="brand-mark">VOXMILL MARKET INTELLIGENCE</div>
    </div>
    
    <div class="cover-content">
        <h1 class="cover-title">Market Intelligence<br/>Snapshot</h1>
        <div class="cover-subtitle">
            {{ area }}, {{ city }} • {{ date }} • Confidential Executive Brief
        </div>
    </div>
    
    <div class="chart-panel glass">
        <div class="panel-header">EXECUTIVE KPI OVERVIEW</div>
        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-value">{{ metrics.total_properties }}</div>
                <div class="kpi-label">Properties Analyzed</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">{{ metrics.exceptional_deals }}</div>
                <div class="kpi-label">Exceptional Deals</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">{{ metrics.hot_deals }}</div>
                <div class="kpi-label">Hot Opportunities</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value">£{{ metrics.avg_price_millions }}M</div>
                <div class="kpi-label">Average Price</div>
            </div>
        </div>
        
        <!-- Hero Chart SVG -->
        <svg class="hero-chart" viewBox="0 0 600 200" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <linearGradient id="bronzeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#CBA135;stop-opacity:0.9" />
                    <stop offset="100%" style="stop-color:#B08D57;stop-opacity:0.9" />
                </linearGradient>
                <filter id="glow">
                    <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                    <feMerge>
                        <feMergeNode in="coloredBlur"/>
                        <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                </filter>
            </defs>
            
            <!-- Grid lines -->
            {% for i in range(5) %}
            <line x1="60" y1="{{ 40 + i * 35 }}" x2="580" y2="{{ 40 + i * 35 }}" 
                  stroke="#2E2E2E" stroke-width="0.5" opacity="0.3"/>
            {% endfor %}
            
            <!-- Bars -->
            {% for i, value in enumerate(chart_data.deal_tiers) %}
            <rect x="{{ 120 + i * 150 }}" y="{{ 180 - value * 1.3 }}" 
                  width="80" height="{{ value * 1.3 }}" 
                  fill="url(#bronzeGrad)" 
                  stroke="#CBA135" stroke-width="1.5" 
                  filter="url(#glow)" 
                  rx="2"/>
            <text x="{{ 160 + i * 150 }}" y="195" 
                  fill="#EAEAEA" font-size="11" text-anchor="middle" font-family="Inter">
                {{ ['EXCEPTIONAL', 'HOT', 'STRONG'][i] }}
            </text>
            <text x="{{ 160 + i * 150 }}" y="{{ 175 - value * 1.3 }}" 
                  fill="#CBA135" font-size="14" text-anchor="middle" font-family="Inter" font-weight="600">
                {{ value }}
            </text>
            {% endfor %}
            
            <!-- Axis labels -->
            <text x="30" y="45" fill="#AFAFAF" font-size="9" font-family="Inter">COUNT</text>
        </svg>
    </div>
    
    <div class="page-footer">
        <div class="watermark">VOXMILL</div>
    </div>
</section>

<!-- PAGE 2: PERFORMANCE ANALYSIS -->
<section class="page page-content">
    <div class="page-header">
        <div class="page-number">02</div>
        <div class="section-title">PERFORMANCE ANALYSIS</div>
    </div>
    
    <div class="dual-chart-layout">
        <div class="chart-panel glass">
            <div class="panel-header">PRICE DISTRIBUTION</div>
            <svg class="analysis-chart" viewBox="0 0 280 180" xmlns="http://www.w3.org/2000/svg">
                <!-- Price bars -->
                {% for i, prop in enumerate(top_properties[:5]) %}
                <rect x="40" y="{{ 20 + i * 30 }}" 
                      width="{{ (prop.price / metrics.max_price) * 200 }}" height="22" 
                      fill="url(#bronzeGrad)" stroke="#CBA135" stroke-width="1" rx="2"/>
                <text x="35" y="{{ 35 + i * 30 }}" 
                      fill="#EAEAEA" font-size="9" text-anchor="end" font-family="Inter">
                    £{{ prop.price_millions }}M
                </text>
                {% endfor %}
            </svg>
        </div>
        
        <div class="chart-panel glass">
            <div class="panel-header">PRICE PER SQFT TREND</div>
            <svg class="analysis-chart" viewBox="0 0 280 180" xmlns="http://www.w3.org/2000/svg">
                <!-- Trend line -->
                <polyline points="{% for i, prop in enumerate(top_properties[:8]) %}{{ 40 + i * 30 }},{{ 160 - (prop.price_per_sqft / 2000) * 120 }} {% endfor %}"
                          fill="none" stroke="#B08D57" stroke-width="2.5" filter="url(#glow)"/>
                <!-- Data points -->
                {% for i, prop in enumerate(top_properties[:8]) %}
                <circle cx="{{ 40 + i * 30 }}" cy="{{ 160 - (prop.price_per_sqft / 2000) * 120 }}" 
                        r="4" fill="#CBA135" stroke="#B08D57" stroke-width="2"/>
                {% endfor %}
            </svg>
        </div>
    </div>
    
    <div class="insight-cards">
        <div class="insight-card">
            <div class="insight-header">Market Velocity</div>
            <div class="insight-body">{{ intelligence.market_velocity }}</div>
        </div>
        <div class="insight-card">
            <div class="insight-header">Deal Quality</div>
            <div class="insight-body">{{ intelligence.deal_quality }}</div>
        </div>
        <div class="insight-card">
            <div class="insight-header">Risk Assessment</div>
            <div class="insight-body">{{ intelligence.risk_level }}</div>
        </div>
    </div>
</section>

<!-- PAGE 3: COMPETITOR LANDSCAPE -->
<section class="page page-content">
    <div class="page-header">
        <div class="page-number">03</div>
        <div class="section-title">COMPETITOR LANDSCAPE</div>
    </div>
    
    <div class="dual-chart-layout">
        <div class="chart-panel glass wide">
            <div class="panel-header">ACTIVE MARKET SHARE</div>
            <svg class="competitor-chart" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                <!-- Horizontal bars for competitors -->
                {% for i, comp in enumerate(competitors[:5]) %}
                <rect x="120" y="{{ 20 + i * 35 }}" 
                      width="{{ comp.share * 250 }}" height="26" 
                      fill="url(#bronzeGrad)" stroke="#CBA135" stroke-width="1" rx="2"/>
                <text x="115" y="{{ 37 + i * 35 }}" 
                      fill="#EAEAEA" font-size="10" text-anchor="end" font-family="Inter">
                    {{ comp.name }}
                </text>
                <text x="{{ 125 + comp.share * 250 }}" y="{{ 37 + i * 35 }}" 
                      fill="#CBA135" font-size="11" font-family="Inter" font-weight="600">
                    {{ comp.count }}
                </text>
                {% endfor %}
            </svg>
        </div>
        
        <div class="chart-panel glass">
            <div class="panel-header">SHARE %</div>
            <svg class="pie-chart" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <!-- Pie slices -->
                {% set total = competitors|sum(attribute='count') %}
                {% set start_angle = 0 %}
                {% for comp in competitors[:5] %}
                {% set angle = (comp.count / total) * 360 %}
                {% set end_angle = start_angle + angle %}
                <path d="M 100,100 L {{ 100 + 80 * cos(start_angle * 3.14159 / 180) }},{{ 100 + 80 * sin(start_angle * 3.14159 / 180) }} 
                         A 80,80 0 {{ '1' if angle > 180 else '0' }},1 
                         {{ 100 + 80 * cos(end_angle * 3.14159 / 180) }},{{ 100 + 80 * sin(end_angle * 3.14159 / 180) }} Z"
                      fill="{{ ['#B08D57', '#CBA135', '#8B6F2E', '#6B5522', '#9A7A3E'][loop.index0] }}" 
                      stroke="#0C0C0C" stroke-width="2"/>
                <text x="{{ 100 + 50 * cos((start_angle + angle/2) * 3.14159 / 180) }}" 
                      y="{{ 100 + 50 * sin((start_angle + angle/2) * 3.14159 / 180) }}" 
                      fill="white" font-size="12" text-anchor="middle" font-family="Inter" font-weight="600">
                    {{ (comp.count / total * 100)|round|int }}%
                </text>
                {% set start_angle = end_angle %}
                {% endfor %}
            </svg>
        </div>
    </div>
</section>

<!-- PAGE 4: STRATEGIC INTELLIGENCE -->
<section class="page page-content">
    <div class="page-header">
        <div class="page-number">04</div>
        <div class="section-title">STRATEGIC INTELLIGENCE</div>
    </div>
    
    <div class="intelligence-blocks">
        <div class="intel-block">
            <div class="intel-divider"></div>
            <h3 class="intel-heading">Executive Summary</h3>
            <p class="intel-text">{{ intelligence.executive_summary }}</p>
        </div>
        
        <div class="intel-block">
            <div class="intel-divider"></div>
            <h3 class="intel-heading">Market Dynamics</h3>
            <p class="intel-text">{{ intelligence.market_dynamics }}</p>
        </div>
        
        <div class="intel-block">
            <div class="intel-divider"></div>
            <h3 class="intel-heading">Strategic Recommendations</h3>
            <p class="intel-text">{{ intelligence.recommendations }}</p>
        </div>
    </div>
    
    <div class="watermark-center">VOXMILL MARKET INTELLIGENCE</div>
</section>

<!-- PAGE 5: TOP OPPORTUNITIES -->
<section class="page page-content">
    <div class="page-header">
        <div class="page-number">05</div>
        <div class="section-title">TOP OPPORTUNITIES</div>
    </div>
    
    <table class="opportunities-table">
        <thead>
            <tr>
                <th>ADDRESS</th>
                <th>PRICE</th>
                <th>BEDS/BATHS</th>
                <th>£/SQFT</th>
                <th>SCORE</th>
            </tr>
        </thead>
        <tbody>
            {% for opp in top_opportunities[:8] %}
            <tr class="{{ 'alt' if loop.index0 % 2 else '' }}">
                <td class="address">{{ opp.address|truncate(35) }}</td>
                <td class="price">£{{ opp.price|format_number }}</td>
                <td class="center">{{ opp.beds }}/{{ opp.baths }}</td>
                <td class="price">£{{ opp.price_per_sqft|format_number }}</td>
                <td class="score">{{ opp.deal_score }}/10</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div class="report-footer">
        <div class="footer-divider"></div>
        <div class="footer-text">
            Voxmill Automations — Confidential Market Intelligence | {{ year }}
        </div>
    </div>
</section>

</body>
</html>
